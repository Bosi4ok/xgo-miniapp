-- u0421u043au0440u0438u043fu0442 u0434u043bu044f u0438u0441u043fu0440u0430u0432u043bu0435u043du0438u044f u043fu043eu043bu0438u0442u0438u043a RLS u0432 Supabase

-- u0412u043au043bu044eu0447u0430u0435u043c RLS u0434u043bu044f u0432u0441u0435u0445 u0442u0430u0431u043bu0438u0446

-- u0412u043au043bu044eu0447u0435u043du0438u0435 RLS u0434u043bu044f u0442u0430u0431u043bu0438u0446u044b users
ALTER TABLE users ENABLE ROW LEVEL SECURITY;

-- u0412u043au043bu044eu0447u0435u043du0438u0435 RLS u0434u043bu044f u0442u0430u0431u043bu0438u0446u044b checkins
ALTER TABLE checkins ENABLE ROW LEVEL SECURITY;

-- u0412u043au043bu044eu0447u0435u043du0438u0435 RLS u0434u043bu044f u0442u0430u0431u043bu0438u0446u044b referrals
ALTER TABLE referrals ENABLE ROW LEVEL SECURITY;

-- u0423u0434u0430u043bu044fu0435u043c u0441u0443u0449u0435u0441u0442u0432u0443u044eu0449u0438u0435 u043fu043eu043bu0438u0442u0438u043au0438, u0435u0441u043bu0438 u043eu043du0438 u0435u0441u0442u044c
DROP POLICY IF EXISTS users_select_policy ON users;
DROP POLICY IF EXISTS users_insert_policy ON users;
DROP POLICY IF EXISTS users_update_policy ON users;

DROP POLICY IF EXISTS checkins_select_policy ON checkins;
DROP POLICY IF EXISTS checkins_insert_policy ON checkins;

DROP POLICY IF EXISTS referrals_select_policy ON referrals;
DROP POLICY IF EXISTS referrals_insert_policy ON referrals;

-- u0421u043eu0437u0434u0430u0435u043c u043fu043eu043bu0438u0442u0438u043au0438 u0434u043bu044f u0442u0430u0431u043bu0438u0446u044b users

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u0447u0442u0435u043du0438u044f (u0440u0430u0437u0440u0435u0448u0430u0435u043c u0432u0441u0435u043c u0430u043du043eu043du0438u043cu043du044bu043c u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044fu043c u0447u0438u0442u0430u0442u044c u0434u0430u043du043du044bu0435)
CREATE POLICY users_select_policy ON users
    FOR SELECT
    USING (true);

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u0432u0441u0442u0430u0432u043au0438 (u0440u0430u0437u0440u0435u0448u0430u0435u043c u0432u0441u0435u043c u0430u043du043eu043du0438u043cu043du044bu043c u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044fu043c u0432u0441u0442u0430u0432u043bu044fu0442u044c u0434u0430u043du043du044bu0435)
CREATE POLICY users_insert_policy ON users
    FOR INSERT
    WITH CHECK (true);

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u043eu0431u043du043eu0432u043bu0435u043du0438u044f (u0440u0430u0437u0440u0435u0448u0430u0435u043c u0432u0441u0435u043c u0430u043du043eu043du0438u043cu043du044bu043c u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044fu043c u043eu0431u043du043eu0432u043bu044fu0442u044c u0434u0430u043du043du044bu0435)
CREATE POLICY users_update_policy ON users
    FOR UPDATE
    USING (true);

-- u0421u043eu0437u0434u0430u0435u043c u043fu043eu043bu0438u0442u0438u043au0438 u0434u043bu044f u0442u0430u0431u043bu0438u0446u044b checkins

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u0447u0442u0435u043du0438u044f
CREATE POLICY checkins_select_policy ON checkins
    FOR SELECT
    USING (true);

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u0432u0441u0442u0430u0432u043au0438
CREATE POLICY checkins_insert_policy ON checkins
    FOR INSERT
    WITH CHECK (true);

-- u0421u043eu0437u0434u0430u0435u043c u043fu043eu043bu0438u0442u0438u043au0438 u0434u043bu044f u0442u0430u0431u043bu0438u0446u044b referrals

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u0447u0442u0435u043du0438u044f
CREATE POLICY referrals_select_policy ON referrals
    FOR SELECT
    USING (true);

-- u041fu043eu043bu0438u0442u0438u043au0430 u0434u043bu044f u0432u0441u0442u0430u0432u043au0438
CREATE POLICY referrals_insert_policy ON referrals
    FOR INSERT
    WITH CHECK (true);
