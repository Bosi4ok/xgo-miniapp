// u041du043eu0432u0430u044f u0444u0443u043du043au0446u0438u044f u0434u043bu044f u043eu0431u043du043eu0432u043bu0435u043du0438u044f u043fu0440u043eu0444u0438u043bu044f
async function updateProfileModal() {
  try {
    console.log('u041eu0431u043du043eu0432u043bu0435u043du0438u0435 u043cu043eu0434u0430u043bu044cu043du043eu0433u043e u043eu043au043du0430 u043fu0440u043eu0444u0438u043bu044f...');
    
    // u041fu043eu043bu0443u0447u0430u0435u043c u044du043bu0435u043cu0435u043du0442 u0441 u0438u043cu0435u043du0435u043c u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0432 u043cu043eu0434u0430u043bu044cu043du043eu043c u043eu043au043du0435
    const userNameModalElement = document.getElementById('user-name-modal');
    if (!userNameModalElement) {
      console.error('u042du043bu0435u043cu0435u043du0442 u0441 u0438u043cu0435u043du0435u043c u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0432 u043cu043eu0434u0430u043bu044cu043du043eu043c u043eu043au043du0435 u043du0435 u043du0430u0439u0434u0435u043d');
      return;
    }
    
    // u041fu0440u043eu0432u0435u0440u044fu0435u043c, u0435u0441u0442u044c u043bu0438 u0438u043cu044f u0432 localStorage
    const savedName = localStorage.getItem('telegram_user_name');
    if (savedName) {
      userNameModalElement.textContent = savedName;
      console.log('u0418u043cu044f u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0443u0441u0442u0430u043du043eu0432u043bu0435u043du043e u0438u0437 localStorage:', savedName);
    } else {
      // u0415u0441u043bu0438 u0438u043cu044f u043du0435 u043du0430u0439u0434u0435u043du043e u0432 localStorage, u0438u0441u043fu043eu043bu044cu0437u0443u0435u043c u0438u043cu044f u043fu043e u0443u043cu043eu043bu0447u0430u043du0438u044e
      const defaultName = 'u0410u0440u0442u0451u043c';
      userNameModalElement.textContent = defaultName;
      console.log('u0418u043cu044f u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0443u0441u0442u0430u043du043eu0432u043bu0435u043du043e u043fu043e u0443u043cu043eu043bu0447u0430u043du0438u044e:', defaultName);
      
      // u0421u043eu0445u0440u0430u043du044fu0435u043c u0438u043cu044f u0432 localStorage u0434u043bu044f u0431u0443u0434u0443u0449u0438u0445 u0441u0435u0441u0441u0438u0439
      localStorage.setItem('telegram_user_name', defaultName);
    }
    
    // u041fu043eu043bu0443u0447u0430u0435u043c ID u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f
    const telegramId = await getTelegramUserId();
    console.log('Telegram ID u0434u043bu044f u043fu0440u043eu0444u0438u043bu044f:', telegramId);
    
    // u041fu043eu043bu0443u0447u0430u0435u043c u0434u0430u043du043du044bu0435 u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0438u0437 u0431u0430u0437u044b u0434u0430u043du043du044bu0445
    const user = await getUser(telegramId);
    console.log('u0414u0430u043du043du044bu0435 u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0434u043bu044f u043fu0440u043eu0444u0438u043bu044f:', user);
    
    // u041fu043eu043bu0443u0447u0430u0435u043c u043au043eu043bu0438u0447u0435u0441u0442u0432u043e u0440u0435u0444u0435u0440u0430u043bu043eu0432
    const referralsCount = await getReferralsCount(telegramId);
    console.log('u041au043eu043bu0438u0447u0435u0441u0442u0432u043e u0440u0435u0444u0435u0440u0430u043bu043eu0432:', referralsCount);
    
    // u041eu0431u043du043eu0432u043bu044fu0435u043c u043au043eu043bu0438u0447u0435u0441u0442u0432u043e u0440u0435u0444u0435u0440u0430u043bu043eu0432 u0432 u043cu043eu0434u0430u043bu044cu043du043eu043c u043eu043au043du0435
    const referralsCountModal = document.getElementById('referrals-count-modal');
    if (referralsCountModal) {
      referralsCountModal.textContent = referralsCount.toString();
      console.log('u041au043eu043bu0438u0447u0435u0441u0442u0432u043e u0440u0435u0444u0435u0440u0430u043bu043eu0432 u043eu0431u043du043eu0432u043bu0435u043du043e u0432 u043cu043eu0434u0430u043bu044cu043du043eu043c u043eu043au043du0435:', referralsCount);
    }
    
    // u041eu0431u043du043eu0432u043bu044fu0435u043c XP u0432 u043cu043eu0434u0430u043bu044cu043du043eu043c u043eu043au043du0435
    const totalXpModal = document.getElementById('total-xp-modal');
    if (totalXpModal && user) {
      totalXpModal.textContent = (user.points || 0).toString();
      console.log('XP u043eu0431u043du043eu0432u043bu0435u043du043e u0432 u043cu043eu0434u0430u043bu044cu043du043eu043c u043eu043au043du0435:', user.points || 0);
    }
    
    // u0421u043eu0445u0440u0430u043du044fu0435u043c u0434u0430u043du043du044bu0435 u043fu043eu043bu044cu0437u043eu0432u0430u0442u0435u043bu044f u0432 u0433u043bu043eu0431u0430u043bu044cu043du0443u044e u043fu0435u0440u0435u043cu0435u043du043du0443u044e u0434u043bu044f u0431u044bu0441u0442u0440u043eu0433u043e u0434u043eu0441u0442u0443u043fu0430
    currentUser = user;
    
    console.log('u041cu043eu0434u0430u043bu044cu043du043eu0435 u043eu043au043du043e u043fu0440u043eu0444u0438u043bu044f u0443u0441u043fu0435u0448u043du043e u043eu0431u043du043eu0432u043bu0435u043du043e');
  } catch (error) {
    console.error('u041eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0431u043du043eu0432u043bu0435u043du0438u0438 u043fu0440u043eu0444u0438u043bu044f:', error);
  }
}
