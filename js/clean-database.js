// u0421u043au0440u0438u043fu0442 u0434u043bu044f u043eu0447u0438u0441u0442u043au0438 u0442u0430u0431u043bu0438u0446u044b users u0432 u0431u0430u0437u0435 u0434u0430u043du043du044bu0445 Supabase

import { supabaseClient } from './modules/database.js';

// u0424u0443u043du043au0446u0438u044f u0434u043bu044f u043eu0447u0438u0441u0442u043au0438 u0442u0430u0431u043bu0438u0446u044b users
async function cleanUsersTable() {
  try {
    console.log('u041du0430u0447u0438u043du0430u0435u043c u043eu0447u0438u0441u0442u043au0443 u0442u0430u0431u043bu0438u0446u044b users...');
    
    // u0423u0434u0430u043bu044fu0435u043c u0432u0441u0435 u0437u0430u043fu0438u0441u0438 u0438u0437 u0442u0430u0431u043bu0438u0446u044b users
    const { error } = await supabaseClient
      .from('users')
      .delete()
      .neq('id', 0); // u0423u0441u043bu043eu0432u0438u0435 neq('id', 0) u0443u0434u0430u043bu044fu0435u0442 u0432u0441u0435 u0437u0430u043fu0438u0441u0438
    
    if (error) {
      console.error('u041eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446u044b users:', error);
      return false;
    }
    
    console.log('u0422u0430u0431u043bu0438u0446u0430 users u0443u0441u043fu0435u0448u043du043e u043eu0447u0438u0449u0435u043du0430!');
    return true;
  } catch (error) {
    console.error('u041au0440u0438u0442u0438u0447u0435u0441u043au0430u044f u043eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446u044b users:', error);
    return false;
  }
}

// u0424u0443u043du043au0446u0438u044f u0434u043bu044f u043eu0447u0438u0441u0442u043au0438 u0442u0430u0431u043bu0438u0446u044b checkins
async function cleanCheckinsTable() {
  try {
    console.log('u041du0430u0447u0438u043du0430u0435u043c u043eu0447u0438u0441u0442u043au0443 u0442u0430u0431u043bu0438u0446u044b checkins...');
    
    // u0423u0434u0430u043bu044fu0435u043c u0432u0441u0435 u0437u0430u043fu0438u0441u0438 u0438u0437 u0442u0430u0431u043bu0438u0446u044b checkins
    const { error } = await supabaseClient
      .from('checkins')
      .delete()
      .neq('id', 0); // u0423u0441u043bu043eu0432u0438u0435 neq('id', 0) u0443u0434u0430u043bu044fu0435u0442 u0432u0441u0435 u0437u0430u043fu0438u0441u0438
    
    if (error) {
      console.error('u041eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446u044b checkins:', error);
      return false;
    }
    
    console.log('u0422u0430u0431u043bu0438u0446u0430 checkins u0443u0441u043fu0435u0448u043du043e u043eu0447u0438u0449u0435u043du0430!');
    return true;
  } catch (error) {
    console.error('u041au0440u0438u0442u0438u0447u0435u0441u043au0430u044f u043eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446u044b checkins:', error);
    return false;
  }
}

// u0424u0443u043du043au0446u0438u044f u0434u043bu044f u043eu0447u0438u0441u0442u043au0438 u0442u0430u0431u043bu0438u0446u044b referrals
async function cleanReferralsTable() {
  try {
    console.log('u041du0430u0447u0438u043du0430u0435u043c u043eu0447u0438u0441u0442u043au0443 u0442u0430u0431u043bu0438u0446u044b referrals...');
    
    // u0423u0434u0430u043bu044fu0435u043c u0432u0441u0435 u0437u0430u043fu0438u0441u0438 u0438u0437 u0442u0430u0431u043bu0438u0446u044b referrals
    const { error } = await supabaseClient
      .from('referrals')
      .delete()
      .neq('id', 0); // u0423u0441u043bu043eu0432u0438u0435 neq('id', 0) u0443u0434u0430u043bu044fu0435u0442 u0432u0441u0435 u0437u0430u043fu0438u0441u0438
    
    if (error) {
      console.error('u041eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446u044b referrals:', error);
      return false;
    }
    
    console.log('u0422u0430u0431u043bu0438u0446u0430 referrals u0443u0441u043fu0435u0448u043du043e u043eu0447u0438u0449u0435u043du0430!');
    return true;
  } catch (error) {
    console.error('u041au0440u0438u0442u0438u0447u0435u0441u043au0430u044f u043eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446u044b referrals:', error);
    return false;
  }
}

// u041eu0447u0438u0449u0430u0435u043c u0432u0441u0435 u0442u0430u0431u043bu0438u0446u044b
async function cleanAllTables() {
  console.log('u041du0430u0447u0438u043du0430u0435u043c u043eu0447u0438u0441u0442u043au0443 u0432u0441u0435u0445 u0442u0430u0431u043bu0438u0446...');
  
  // u041eu0447u0438u0449u0430u0435u043c u0442u0430u0431u043bu0438u0446u044b u0432 u043fu0440u0430u0432u0438u043bu044cu043du043eu043c u043fu043eu0440u044fu0434u043au0435, u0447u0442u043eu0431u044b u043du0435 u043du0430u0440u0443u0448u0438u0442u044c u0446u0435u043bu043eu0441u0442u043du043eu0441u0442u044c u0434u0430u043du043du044bu0445
  await cleanCheckinsTable();
  await cleanReferralsTable();
  await cleanUsersTable();
  
  console.log('u0412u0441u0435 u0442u0430u0431u043bu0438u0446u044b u0443u0441u043fu0435u0448u043du043e u043eu0447u0438u0449u0435u043du044b!');
}

// u0417u0430u043fu0443u0441u043au0430u0435u043c u043eu0447u0438u0441u0442u043au0443 u0432u0441u0435u0445 u0442u0430u0431u043bu0438u0446 u043fu0440u0438 u0437u0430u0433u0440u0443u0437u043au0435 u0441u043au0440u0438u043fu0442u0430
cleanAllTables().then(() => {
  console.log('u041eu0447u0438u0449u0430u0435u043c u0437u0430u0432u0435u0440u0448u0435u043du0430, u043cu043eu0436u043du043e u043fu0435u0440u0435u0437u0430u0433u0440u0443u0437u0438u0442u044c u0441u0442u0440u0430u043du0438u0446u0443');
}).catch(error => {
  console.error('u041eu0448u0438u0431u043au0430 u043fu0440u0438 u043eu0447u0438u0441u0442u043au0435 u0442u0430u0431u043bu0438u0446:', error);
});
